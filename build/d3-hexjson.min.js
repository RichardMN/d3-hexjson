!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],e):e(r.d3=r.d3||{},r.d3)}(this,function(r,e){"use strict";function n(r,n,a){var o=r.layout,x=[],i=0;Object.keys(r.hexes).forEach(function(e){r.hexes[e].key=e,x.push(r.hexes[e])});var y=e.max(x,function(r){return+r.q}),h=e.min(x,function(r){return+r.q}),f=e.max(x,function(r){return+r.r}),d=e.min(x,function(r){return+r.r}),q=y-h+1,p=f-d+1;i="odd-r"===o||"even-r"===o?e.min([n/((q+.5)*Math.sqrt(3)),a/(1.5*(p+1/3))]):e.min([a/((p+.5)*Math.sqrt(3)),n/(1.5*(q+1/3))]);var v=i*Math.sqrt(3),m=c(o,v,i),b=s(m);return x.forEach(function(r){r.qc=r.q-h,r.rc=f-r.r,r.x=t(r,o,v,i),r.y=u(r,o,v,i),r.vertices=m,r.points=b}),x}function t(r,e,n,t){var u=0,c=0;switch(e){case"odd-r":c=r.rc%2==1?n:n/2,u=r.qc*n+c;break;case"even-r":c=r.rc%2==0?n:n/2,u=r.qc*n+c;break;case"odd-q":case"even-q":u=r.qc*t*1.5+t}return u}function u(r,e,n,t){var u=0,c=0;switch(e){case"odd-r":case"even-r":u=r.rc*t*1.5+t;break;case"odd-q":c=r.qc%2==1?n:n/2,u=r.rc*n+c;break;case"even-q":c=r.qc%2==0?n:n/2,u=r.rc*n+c}return u}function c(r,e,n){var t=[];switch(r){case"odd-r":case"even-r":t.push({x:0,y:0-n}),t.push({x:0+.5*e,y:0-.5*n}),t.push({x:0+.5*e,y:0+.5*n}),t.push({x:0,y:0+n}),t.push({x:0-.5*e,y:0+.5*n}),t.push({x:0-.5*e,y:0-.5*n});break;case"odd-q":case"even-q":t.push({x:0-n,y:0}),t.push({x:0-.5*n,y:0-.5*e}),t.push({x:0+.5*n,y:0-.5*e}),t.push({x:0+n,y:0}),t.push({x:0+.5*n,y:0+.5*e}),t.push({x:0-.5*n,y:0+.5*e})}return t}function s(r){var e="";return r.forEach(function(r){e+=r.x+","+r.y+" "}),e.substring(0,e.length-1)}function a(r){var n={};n.layout=r.layout,n.hexes={};var t=[];Object.keys(r.hexes).forEach(function(e){t.push(r.hexes[e])});var u,c,s,a=e.max(t,function(r){return+r.q}),o=e.min(t,function(r){return+r.q}),x=e.max(t,function(r){return+r.r}),i=e.min(t,function(r){return+r.r});for(u=o;u<=a;u++)for(c=i;c<=x;c++)s="Q"+u+"R"+c,n.hexes[s]={q:u,r:c};return n}function o(r,n,c,s){var a=[];const o=r.layout;Object.keys(r.hexes).forEach(function(e){a.push(r.hexes[e])});var x,i=e.max(a,function(r){return+r.q}),y=e.min(a,function(r){return+r.q}),h=e.max(a,function(r){return+r.r}),f=e.min(a,function(r){return+r.r}),d=i-y+1,q=h-f+1;x="odd-r"===o||"even-r"===o?e.min([n/((d+.5)*Math.sqrt(3)),c/(1.5*(q+1/3))]):e.min([c/((q+.5)*Math.sqrt(3)),n/(1.5*(d+1/3))]);var p=x*Math.sqrt(3),v=[];const m=x*x*4,b=a.length;if(b>1){a.forEach(function(r){r.qc=r.q-y,r.rc=h-r.r,r.x=t(r,o,p,x),r.y=u(r,o,p,x)});for(var M=0;M<b-1;M++)for(var k=M+1;k<b;k++){var l=a[M],O=a[k];if(l[s]!=O[s]&&Math.abs(l.q-O.q)<=1&&Math.abs(l.r-O.r)<=1&&(l.x-O.x)*(l.x-O.x)+(l.y-O.y)*(l.y-O.y)<m){var E={};E.x=O.x+(l.x-O.x)/2,E.y=O.y+(l.y-O.y)/2;var g={};const j=4*Math.sqrt(3);g.dx=(l.y-O.y)/j,g.dy=-(l.x-O.x)/j,v.push({x:E.x-2*g.dx,y:E.y-2*g.dy}),v.push({x:E.x-g.dx,y:E.y-g.dy}),v.push({x:E.x,y:E.y}),v.push({x:E.x+g.dx,y:E.y+g.dy}),v.push({x:E.x+2*g.dx,y:E.y+2*g.dy})}}}return v}r.renderHexJSON=n,r.getGridForHexJSON=a,r.getBoundariesForHexJSON=o,Object.defineProperty(r,"__esModule",{value:!0})});