!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],e):e(r.d3=r.d3||{},r.d3)}(this,function(r,e){"use strict";function n(r,n,a){var s=r.layout,i=[],f=0;Object.keys(r.hexes).forEach(function(e){r.hexes[e].key=e,i.push(r.hexes[e])});var h=e.max(i,function(r){return+r.q}),x=e.min(i,function(r){return+r.q}),y=e.max(i,function(r){return+r.r}),q=e.min(i,function(r){return+r.r}),d=h-x+1,p=y-q+1;f="odd-r"===s||"even-r"===s?e.min([n/((d+.5)*Math.sqrt(3)),a/(1.5*(p+1/3))]):e.min([a/((p+.5)*Math.sqrt(3)),n/(1.5*(d+1/3))]);var v=f*Math.sqrt(3),m=o(s,v,f),l=c(m);return i.forEach(function(r){r.qc=r.q-x,r.rc=y-r.r,r.x=t(r,s,v,f),r.y=u(r,s,v,f),r.vertices=m,r.points=l}),i}function t(r,e,n,t){var u=0,o=0;switch(e){case"odd-r":o=r.rc%2==1?n:n/2,u=r.qc*n+o;break;case"even-r":o=r.rc%2==0?n:n/2,u=r.qc*n+o;break;case"odd-q":case"even-q":u=r.qc*t*1.5+t}return u}function u(r,e,n,t){var u=0,o=0;switch(e){case"odd-r":case"even-r":u=r.rc*t*1.5+t;break;case"odd-q":o=r.qc%2==1?n:n/2,u=r.rc*n+o;break;case"even-q":o=r.qc%2==0?n:n/2,u=r.rc*n+o}return u}function o(r,e,n){var t=[];switch(r){case"odd-r":case"even-r":t.push({x:0,y:0-n}),t.push({x:0+.5*e,y:0-.5*n}),t.push({x:0+.5*e,y:0+.5*n}),t.push({x:0,y:0+n}),t.push({x:0-.5*e,y:0+.5*n}),t.push({x:0-.5*e,y:0-.5*n});break;case"odd-q":case"even-q":t.push({x:0-n,y:0}),t.push({x:0-.5*n,y:0-.5*e}),t.push({x:0+.5*n,y:0-.5*e}),t.push({x:0+n,y:0}),t.push({x:0+.5*n,y:0+.5*e}),t.push({x:0-.5*n,y:0+.5*e})}return t}function c(r){var e="";return r.forEach(function(r){e+=r.x+","+r.y+" "}),e.substring(0,e.length-1)}function a(r){var n={};n.layout=r.layout,n.hexes={};var t=[];Object.keys(r.hexes).forEach(function(e){t.push(r.hexes[e])});var u,o,c,a=e.max(t,function(r){return+r.q}),s=e.min(t,function(r){return+r.q}),i=e.max(t,function(r){return+r.r}),f=e.min(t,function(r){return+r.r});for(u=s;u<=a;u++)for(o=f;o<=i;o++)c="Q"+u+"R"+o,n.hexes[c]={q:u,r:o};return n}function s(r,e){return r+":"+e}function i(r,n,a,i){var f={};f.layout=r.layout,f.hexes={};var h=[],x=new Map,y=[];Object.keys(r.hexes).forEach(function(e){h.push(r.hexes[e]),x.set(s(r.hexes[e].q,r.hexes[e].r),e)});var q,d,p,v=e.max(h,function(r){return+r.q}),m=e.min(h,function(r){return+r.q}),l=e.max(h,function(r){return+r.r}),b=e.min(h,function(r){return+r.r});for(q=m;q<=v;q++)for(d=b;d<=l;d++)p="Q"+q+"R"+d,f.hexes[p]={q:q,r:d};var k=o(f.layout,n,a);k.push(k[0]);var E=c(k);const O=[{i:0,q:0,r:1},{i:1,q:1,r:1},{i:2,q:1,r:0},{i:3,q:1,r:-1},{i:4,q:0,r:-1},{i:5,q:-1,r:0}];return h.forEach(function(r){r.x=t(r,f.layout,n,a),r.y=u(r,f.layout,n,a),O.forEach(function(e){var n=s(r.q+e.q,r.r+e.r);if(x.has(n)){var t=x.get(n).key;i in r&&t in h&&r[i]!=h[t].getProperty(i)&&y.push({x:r.x,y:r.y,start:E[e.i],stop:E[e.i+1]})}})}),y}r.renderHexJSON=n,r.getGridForHexJSON=a,r.getBoundariesForHexJSON=i,Object.defineProperty(r,"__esModule",{value:!0})});